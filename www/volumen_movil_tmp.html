<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="width=device-width, initial-scale=1, maximun-scale=no">
        <script type="text/javascript" src="js/jquery-1.8.0.min.js"></script>
        <link rel="stylesheet" type="text/css" href="fonts/fonts.css">     
        <!--link href="css/visor_volumen_graphite.css" rel="stylesheet" type="text/css" /-->
        <style type="text/css">
            .ocultar {
                display: none;
            }
            .mostrar {
                display: block;
            }
        </style>
        <title>Vista Detalles</title>
        <script type="text/javascript" src="js/connect.js">
            //queryData(STORED_PROCEDURE, ['integer','1','string','abc','',1], function)
        </script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            $.space2 = {
                clicks: ''
            };
            queryData('USP_VBC_GET_MATRIX_VIEWER', ['integer','12','integer','0','integer','0','integer','16','integer','1'], visor);
            function visor(dataSet) {
                var rec = dataSet[0];
                var text = '';
                var boole = false;
                var como = "";
                var nodos = [];
                var numNodo = 0;
                for(var idx = 0; idx < dataSet.length; idx++){
                    rec = dataSet[idx];
                    text += "<li class='ocultar'><a onClick='link(this.id)' class='li" +rec['userIdUp']+ "' id='" +rec['userId']+ "' href='#'>" +rec['name']+ "</a></li><ul class='ul" +rec['userId']+ "'></ul>\n";
                    //text = '<li><a id="' +rec['userId']+ '" href="#">' +rec['name']+ '</a></li>';
                }
                // for(var idx = 0; idx < dataSet.length; idx++){
                //     rec = dataSet[idx];
                //     if (rec['levelPosition'] == 1) {
                //         //text += "</li>\n</ul>\n<ul>\n<li>"+rec['userId']+" - " +rec['name'];
                //         var users = [];
                //         numNodo = rec['userId'];
                //         //continue;
                //     }
                //     //text += "<li>" +rec['userId']+ " - " +rec['name']+ "</li>\n";
                //     users[rec['userId']] = '<li>' +rec['userIdUp']+ '-' +rec['name']+ '</li>';
                //     nodos[numNodo] = users;
                //     //text += "<span class='ocultar " +rec['userIdUp']+ "'><a id='" +rec['userId']+ "' href='#'>" +rec['name']+ "</a></span>\n";
                // }
                
                //var graphite = document.querySelector('.graphite');
                //graphite.innerHTML = text;
                $('.graphite').html(text);
                //Debug(nodos);
                
                
                /*$('a').click(function() {
                    var id = $(this).attr('id');
                    if ($.space2.clicks == id) {
                        $('.'+id).addClass('ocultar');
                        $('.'+id).removeClass('mostrar');
                        $.space2.clicks = '';
                    } else {
                        $('.'+id).addClass('mostrar');
                        $('.'+id).removeClass('ocultar');
                        $.space2.clicks = id;
                    }
                });*/
                $('li:nth-child(1)').addClass('mostrar');
            }
            //var nod1 = document.querySelector('li:nth-child(2)');
            //nod1.classList.add('mostrar');
            
            
            
        });
        
        function link(id) {
            var id = id;
            var uladd = document.querySelector('.ul'+id);

            var liadd = document.querySelectorAll('.li'+id);
            for (var i = 0; i < liadd.length; i++) {
                uladd.innerHTML += '<li>' +liadd[i].parentNode.innerHTML+ '</li><ul id="ul' +liadd[i].id+ '"></ul>';
            }
        }

        </script>
    </head>
    <body>
        <div>

            <div>
                <h1>Visor de volumen</h1>
                <div class="menu_bar">
                    <a href="#" class="bt-menu" id="showMenu"><span class="icon-menu"></span> Menu</a>
                </div>
            </div>

            <div>
               

<!-- ***************************************************** -->
<!-- ***************************************************** -->
<!-- ***************************************************** -->
<div style="text-align: right" id='divPeriodo'>
    <select  id="periodo" name="periodo">
    </select>
</div>
<ul class="graphite">
    <!-- Desde la Base -->
</ul>
<div class="clear"></div>


<!-- ***************************************************** -->
<!-- ***************************************************** -->
<!-- ***************************************************** -->



            </div>
        </div>

    <div id="deviceready" style="display: none">
        <p class="event listening">Connecting to Device</p>
        <p class="event received">Device is Ready</p>
    </div>
    
    <!-- ********  MENÚ  ******** -->
    <header>
        <nav id="menu"></nav>
    </header>
    <section id="mascara"></section>
    
    <script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
    
    <script type="text/javascript" charset="utf-8" src="js/classMenu.js"></script>
    <script type="text/javascript" src="js/menu.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/logout.js"></script>
    <script type="text/javascript" charset="utf-8" src="js/notificaciones.js"></script>

    <!--script type="text/javascript" src="js/visor_volumen_jquery.cookie.js"></script-->
    <!--script type="text/javascript" src="js/visor_volumen_jquery.dcdrilldown.1.2.js"--></script>

    <script type="text/javascript"> 
            //El registro al servicio de google lo hacemos automáticamente
            app.initialize();            
            menu.cargarMenu();
    </script>
    </body>
</html>